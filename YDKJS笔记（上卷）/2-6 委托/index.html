<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>委托 | yams</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/blog/logo.ico">
    <link rel="alternate" type="application/atom+xml" href="https://melogra.github.io/blog/atom.xml" title="yams Atom Feed">
    <link rel="alternate" type="application/json" href="https://melogra.github.io/blog/feed.json" title="yams JSON Feed">
    <link rel="alternate" type="application/rss+xml" href="https://melogra.github.io/blog/rss.xml" title="yams RSS Feed">
    <link rel="manifest" href="/blog/manifest.webmanifest" crossorigin="use-credentials">
    <meta name="description" content="记录些笔记、写点文章">
    <meta property="og:url" content="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98.html">
    <meta property="og:site_name" content="yams">
    <meta property="og:title" content="委托">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="yams">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link rel="preload" href="/blog/assets/css/0.styles.03982947.css" as="style"><link rel="preload" href="/blog/assets/js/app.79f116af.js" as="script"><link rel="preload" href="/blog/assets/js/vendors~layout-Layout.8c2cbbba.js" as="script"><link rel="preload" href="/blog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.1c0cc028.js" as="script"><link rel="preload" href="/blog/assets/js/page-委托.f8d0b6b3.js" as="script"><link rel="preload" href="/blog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.abaae08c.js" as="script"><link rel="prefetch" href="/blog/assets/js/100.6953d3b1.js"><link rel="prefetch" href="/blog/assets/js/97.466ba357.js"><link rel="prefetch" href="/blog/assets/js/98.9a6f37fb.js"><link rel="prefetch" href="/blog/assets/js/99.ee350fc0.js"><link rel="prefetch" href="/blog/assets/js/layout-Blog.7f400b59.js"><link rel="prefetch" href="/blog/assets/js/layout-Layout.196029ba.js"><link rel="prefetch" href="/blog/assets/js/layout-NotFound.f2c22223.js"><link rel="prefetch" href="/blog/assets/js/layout-Slide.4115f912.js"><link rel="prefetch" href="/blog/assets/js/page--002ed876.4bb44440.js"><link rel="prefetch" href="/blog/assets/js/page--04eae565.b792e571.js"><link rel="prefetch" href="/blog/assets/js/page--0d538476.f53d0362.js"><link rel="prefetch" href="/blog/assets/js/page--12629348.4528d88c.js"><link rel="prefetch" href="/blog/assets/js/page--1d7a7df4.feafedae.js"><link rel="prefetch" href="/blog/assets/js/page--1dfb0404.e6d6238d.js"><link rel="prefetch" href="/blog/assets/js/page--279462f4.71f59ecb.js"><link rel="prefetch" href="/blog/assets/js/page--3238bd69.266e6eee.js"><link rel="prefetch" href="/blog/assets/js/page--3d35b0b4.5626b7f4.js"><link rel="prefetch" href="/blog/assets/js/page--3e1c6620.944f8680.js"><link rel="prefetch" href="/blog/assets/js/page--3e820239.42b48335.js"><link rel="prefetch" href="/blog/assets/js/page--49475190.a7524cc4.js"><link rel="prefetch" href="/blog/assets/js/page--4ae3e825.1415cccf.js"><link rel="prefetch" href="/blog/assets/js/page--4f0b1788.9e40ec2a.js"><link rel="prefetch" href="/blog/assets/js/page--56158492.ca728f29.js"><link rel="prefetch" href="/blog/assets/js/page--5bfbb8e2.016e4207.js"><link rel="prefetch" href="/blog/assets/js/page--713b5b8f.5772e9a1.js"><link rel="prefetch" href="/blog/assets/js/page--71dd4d7c.e51c04b0.js"><link rel="prefetch" href="/blog/assets/js/page--734bba64.4e8adb71.js"><link rel="prefetch" href="/blog/assets/js/page--73b6552a.6592e742.js"><link rel="prefetch" href="/blog/assets/js/page--75d9a56a.2c5a72cb.js"><link rel="prefetch" href="/blog/assets/js/page--769fba07.ef236ae8.js"><link rel="prefetch" href="/blog/assets/js/page--7b7b7871.3087d6a5.js"><link rel="prefetch" href="/blog/assets/js/page--8ae5e074.1d65327e.js"><link rel="prefetch" href="/blog/assets/js/page--8ceb193e.6be97d18.js"><link rel="prefetch" href="/blog/assets/js/page--c5e88efc.b8d57d18.js"><link rel="prefetch" href="/blog/assets/js/page--d5e363e8.a090eae8.js"><link rel="prefetch" href="/blog/assets/js/page--e0227e4c.635b8cb4.js"><link rel="prefetch" href="/blog/assets/js/page--f45b73ce.47bb02b8.js"><link rel="prefetch" href="/blog/assets/js/page--f6a40dec.fa60de74.js"><link rel="prefetch" href="/blog/assets/js/page-ES6+.f2183346.js"><link rel="prefetch" href="/blog/assets/js/page-ES现在与未来.e99a3d37.js"><link rel="prefetch" href="/blog/assets/js/page-Home.bae9ecae.js"><link rel="prefetch" href="/blog/assets/js/page-MIPS汇编入门.c7911d5b.js"><link rel="prefetch" href="/blog/assets/js/page-Promise.f910ba5f.js"><link rel="prefetch" href="/blog/assets/js/page-asynquence库.7e60c3a3.js"><link rel="prefetch" href="/blog/assets/js/page-n皇后问题.1bb28ab1.js"><link rel="prefetch" href="/blog/assets/js/page-this概览.3c48ce0f.js"><link rel="prefetch" href="/blog/assets/js/page-this详解.668300a9.js"><link rel="prefetch" href="/blog/assets/js/page-什么是计算机.c7f27275.js"><link rel="prefetch" href="/blog/assets/js/page-代码组织.7885d4d1.js"><link rel="prefetch" href="/blog/assets/js/page-作用域与编译器.1d5954e9.js"><link rel="prefetch" href="/blog/assets/js/page-作用域与闭包.51a9cac9.js"><link rel="prefetch" href="/blog/assets/js/page-值.fa965520.js"><link rel="prefetch" href="/blog/assets/js/page-元编程.97eb925e.js"><link rel="prefetch" href="/blog/assets/js/page-函数作用域与块作用域.b22c33ed.js"><link rel="prefetch" href="/blog/assets/js/page-分治策略.b95fba01.js"><link rel="prefetch" href="/blog/assets/js/page-动态作用域.fcf09a44.js"><link rel="prefetch" href="/blog/assets/js/page-动态规划.c8f88eba.js"><link rel="prefetch" href="/blog/assets/js/page-原型.54ae321b.js"><link rel="prefetch" href="/blog/assets/js/page-原生函数.f1ea447a.js"><link rel="prefetch" href="/blog/assets/js/page-回溯算法.bd870dda.js"><link rel="prefetch" href="/blog/assets/js/page-回调.2d555855.js"><link rel="prefetch" href="/blog/assets/js/page-声明提升.3831ffea.js"><link rel="prefetch" href="/blog/assets/js/page-对象.74f83dfe.js"><link rel="prefetch" href="/blog/assets/js/page-对象的内容.773f8165.js"><link rel="prefetch" href="/blog/assets/js/page-异步流控制.b56c7d29.js"><link rel="prefetch" href="/blog/assets/js/page-异步：现在与将来.cb47e3f0.js"><link rel="prefetch" href="/blog/assets/js/page-强制类型转换.4fbd80f4.js"><link rel="prefetch" href="/blog/assets/js/page-思维导图.8e5da4af.js"><link rel="prefetch" href="/blog/assets/js/page-性能测试与调优.04a760b8.js"><link rel="prefetch" href="/blog/assets/js/page-投资问题.d691bc22.js"><link rel="prefetch" href="/blog/assets/js/page-新增API.02f56b0c.js"><link rel="prefetch" href="/blog/assets/js/page-最优装载问题.6434aab3.js"><link rel="prefetch" href="/blog/assets/js/page-最小延迟调度.5d1b4ac9.js"><link rel="prefetch" href="/blog/assets/js/page-最长公共子序列.73117490.js"><link rel="prefetch" href="/blog/assets/js/page-浏览器原理.f49da45e.js"><link rel="prefetch" href="/blog/assets/js/page-深入JavaScript.568f1cab.js"><link rel="prefetch" href="/blog/assets/js/page-深入“你不知道的JavaScript系列”.cb96c127.js"><link rel="prefetch" href="/blog/assets/js/page-深入编程.d91d7051.js"><link rel="prefetch" href="/blog/assets/js/page-混合环境JavaScript.466b0a8e.js"><link rel="prefetch" href="/blog/assets/js/page-生成器.a732c841.js"><link rel="prefetch" href="/blog/assets/js/page-程序性能.652ce070.js"><link rel="prefetch" href="/blog/assets/js/page-算法的研究内容.5d64100b.js"><link rel="prefetch" href="/blog/assets/js/page-类型.b35094c5.js"><link rel="prefetch" href="/blog/assets/js/page-类设计模式与JavaScript对象机制.c5183924.js"><link rel="prefetch" href="/blog/assets/js/page-网址收藏.a25ad96e.js"><link rel="prefetch" href="/blog/assets/js/page-背包问题.5cd38670.js"><link rel="prefetch" href="/blog/assets/js/page-词法作用域.d794d6c6.js"><link rel="prefetch" href="/blog/assets/js/page-语法.aef3dbc3.js"><link rel="prefetch" href="/blog/assets/js/page-贪心算法.eb7a2dbe.js"><link rel="prefetch" href="/blog/assets/js/page-进程.4e5c473f.js"><link rel="prefetch" href="/blog/assets/js/page-选择问题.bfc5e025.js"><link rel="prefetch" href="/blog/assets/js/page-集合.4e946d75.js"><link rel="prefetch" href="/blog/assets/js/page-高级异步模式.2ff24d8b.js"><link rel="prefetch" href="/blog/assets/js/vendors~flowchart.bf3a6b81.js"><link rel="prefetch" href="/blog/assets/js/vendors~photo-swipe.e03d03b4.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.03982947.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/blog/" class="home-link router-link-active"><!----> <!----> <span class="site-name can-hide">yams</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title"><!---->
        YDKJS笔记
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/blog/YDKJS笔记（上卷）/1-1 作用域与编译器.html" class="nav-link"><!---->
  上卷
</a></li><li class="dropdown-item"><a href="/blog/YDKJS笔记（中卷）/1-1 类型.html" class="nav-link"><!---->
  中卷
</a></li><li class="dropdown-item"><a href="/blog/YDKJS笔记（下卷）/1-1 深入编程.html" class="nav-link"><!---->
  下卷
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title"><!---->
        计算机基础
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/blog/计算机基础/操作系统/进程.html" class="nav-link"><!---->
  操作系统
</a></li><li class="dropdown-item"><a href="/blog/计算机基础/编译原理/词法分析.html" class="nav-link"><!---->
  编译原理
</a></li><li class="dropdown-item"><a href="/blog/计算机基础/计算机图形学/渲染管道.html" class="nav-link"><!---->
  计算机图形学
</a></li><li class="dropdown-item"><a href="/blog/计算机基础/汇编语言/x86.html" class="nav-link"><!---->
  汇编语言
</a></li><li class="dropdown-item"><a href="/blog/计算机基础/计算机体系结构/寄存器.html" class="nav-link"><!---->
  计算机体系结构
</a></li><li class="dropdown-item"><a href="/blog/计算机基础/计算机网络/" class="nav-link"><!---->
  计算机网络
</a></li></ul></div></div><div class="nav-item"><a href="/blog/algorithm/相关概念.html" class="nav-link"><!---->
  经典算法
</a></div><div class="nav-item"><a href="/blog/杂谈/网址收藏.html" class="nav-link"><!---->
  杂谈
</a></div><div class="nav-item"><a href="https://github.com/melogra" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div></nav> <!----> <!----> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!----> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title"><!---->
      YDKJS笔记
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/YDKJS笔记（上卷）/1-1 作用域与编译器.html" class="nav-link"><!---->
  上卷
</a></li><li class="dropdown-item"><!----> <a href="/blog/YDKJS笔记（中卷）/1-1 类型.html" class="nav-link"><!---->
  中卷
</a></li><li class="dropdown-item"><!----> <a href="/blog/YDKJS笔记（下卷）/1-1 深入编程.html" class="nav-link"><!---->
  下卷
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title"><!---->
      计算机基础
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/计算机基础/操作系统/进程.html" class="nav-link"><!---->
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/blog/计算机基础/编译原理/词法分析.html" class="nav-link"><!---->
  编译原理
</a></li><li class="dropdown-item"><!----> <a href="/blog/计算机基础/计算机图形学/渲染管道.html" class="nav-link"><!---->
  计算机图形学
</a></li><li class="dropdown-item"><!----> <a href="/blog/计算机基础/汇编语言/x86.html" class="nav-link"><!---->
  汇编语言
</a></li><li class="dropdown-item"><!----> <a href="/blog/计算机基础/计算机体系结构/寄存器.html" class="nav-link"><!---->
  计算机体系结构
</a></li><li class="dropdown-item"><!----> <a href="/blog/计算机基础/计算机网络/" class="nav-link"><!---->
  计算机网络
</a></li></ul></div></div><div class="nav-item"><a href="/blog/algorithm/相关概念.html" class="nav-link"><!---->
  经典算法
</a></div><div class="nav-item"><a href="/blog/杂谈/网址收藏.html" class="nav-link"><!---->
  杂谈
</a></div><div class="nav-item"><a href="https://github.com/melogra" target="_blank" rel="noopener noreferrer" class="nav-link external"><!---->
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><!----> <span class="title">你不知道的JS笔记（上卷）</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-1%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E7%BC%96%E8%AF%91%E5%99%A8/" class="sidebar-link">1-1 作用域与编译器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-1%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E7%BC%96%E8%AF%91%E5%99%A8/#作用域" class="sidebar-link">作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-1%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E7%BC%96%E8%AF%91%E5%99%A8/#编译原理" class="sidebar-link heading3">编译原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-1%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E7%BC%96%E8%AF%91%E5%99%A8/#理解作用域" class="sidebar-link">理解作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-1%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E7%BC%96%E8%AF%91%E5%99%A8/#lhs和rhs" class="sidebar-link heading3">LHS和RHS</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-1%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E7%BC%96%E8%AF%91%E5%99%A8/#作用域嵌套" class="sidebar-link heading3">作用域嵌套</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-1%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E7%BC%96%E8%AF%91%E5%99%A8/#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-2%20%E8%AF%8D%E6%B3%95%E4%BD%9C%E7%94%A8%E5%9F%9F/" class="sidebar-link">1-2 词法作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-2%20%E8%AF%8D%E6%B3%95%E4%BD%9C%E7%94%A8%E5%9F%9F/#词法作用域-2" class="sidebar-link">词法作用域</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-2%20%E8%AF%8D%E6%B3%95%E4%BD%9C%E7%94%A8%E5%9F%9F/#用eval和with修改作用域" class="sidebar-link">用`eval`和`with`修改作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-2%20%E8%AF%8D%E6%B3%95%E4%BD%9C%E7%94%A8%E5%9F%9F/#eval" class="sidebar-link heading3">eval</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-2%20%E8%AF%8D%E6%B3%95%E4%BD%9C%E7%94%A8%E5%9F%9F/#with" class="sidebar-link heading3">with</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-2%20%E8%AF%8D%E6%B3%95%E4%BD%9C%E7%94%A8%E5%9F%9F/#eval-和-with-对性能的影响" class="sidebar-link heading3">eval 和 with 对性能的影响</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-2%20%E8%AF%8D%E6%B3%95%E4%BD%9C%E7%94%A8%E5%9F%9F/#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-3%20%E5%87%BD%E6%95%B0%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%9D%97%E4%BD%9C%E7%94%A8%E5%9F%9F/" class="sidebar-link">1-3 函数作用域和块作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-3%20%E5%87%BD%E6%95%B0%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%9D%97%E4%BD%9C%E7%94%A8%E5%9F%9F/#函数作用域" class="sidebar-link">函数作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-3%20%E5%87%BD%E6%95%B0%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%9D%97%E4%BD%9C%E7%94%A8%E5%9F%9F/#函数作用域的应用" class="sidebar-link heading3">函数作用域的应用</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-3%20%E5%87%BD%E6%95%B0%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%9D%97%E4%BD%9C%E7%94%A8%E5%9F%9F/#匿名、具名函数和立即执行函数表达式" class="sidebar-link heading3">匿名、具名函数和立即执行函数表达式</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-3%20%E5%87%BD%E6%95%B0%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%9D%97%E4%BD%9C%E7%94%A8%E5%9F%9F/#块作用域" class="sidebar-link">块作用域</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-3%20%E5%87%BD%E6%95%B0%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%9D%97%E4%BD%9C%E7%94%A8%E5%9F%9F/#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-4%20%E5%A3%B0%E6%98%8E%E6%8F%90%E5%8D%87/" class="sidebar-link">1-4 声明提升</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-4%20%E5%A3%B0%E6%98%8E%E6%8F%90%E5%8D%87/#声明提升-2" class="sidebar-link">声明提升</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-4%20%E5%A3%B0%E6%98%8E%E6%8F%90%E5%8D%87/#函数表达式不会被提升" class="sidebar-link heading3">函数表达式不会被提升</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-4%20%E5%A3%B0%E6%98%8E%E6%8F%90%E5%8D%87/#函数优先于变量提升" class="sidebar-link heading3">函数优先于变量提升</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-4%20%E5%A3%B0%E6%98%8E%E6%8F%90%E5%8D%87/#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-5%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E9%97%AD%E5%8C%85/" class="sidebar-link">1-5 作用域与闭包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-5%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E9%97%AD%E5%8C%85/#闭包" class="sidebar-link">闭包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-5%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E9%97%AD%E5%8C%85/#循环与闭包" class="sidebar-link heading3">循环与闭包</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-5%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E9%97%AD%E5%8C%85/#模块" class="sidebar-link heading3">模块</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/1-5%20%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E9%97%AD%E5%8C%85/#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-1%20this%E6%A6%82%E8%A7%88/" class="sidebar-link">2-1 this概览</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-1%20this%E6%A6%82%E8%A7%88/#this概览-2" class="sidebar-link">this概览</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-1%20this%E6%A6%82%E8%A7%88/#小结" class="sidebar-link">小结</a></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-2%20this%E8%AF%A6%E8%A7%A3/" class="sidebar-link">2-2 this详解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-2%20this%E8%AF%A6%E8%A7%A3/#绑定规则" class="sidebar-link">绑定规则</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-2%20this%E8%AF%A6%E8%A7%A3/#默认绑定" class="sidebar-link heading3">默认绑定</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-2%20this%E8%AF%A6%E8%A7%A3/#隐式绑定" class="sidebar-link heading3">隐式绑定</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-2%20this%E8%AF%A6%E8%A7%A3/#显式绑定" class="sidebar-link heading3">显式绑定</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-2%20this%E8%AF%A6%E8%A7%A3/#new-绑定" class="sidebar-link heading3">new 绑定</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-2%20this%E8%AF%A6%E8%A7%A3/#绑定规则的优先级" class="sidebar-link">绑定规则的优先级</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-2%20this%E8%AF%A6%E8%A7%A3/#绑定例外" class="sidebar-link">绑定例外</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-2%20this%E8%AF%A6%E8%A7%A3/#软绑定" class="sidebar-link heading3">软绑定</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-2%20this%E8%AF%A6%E8%A7%A3/#箭头函数与this" class="sidebar-link heading3">箭头函数与this</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-2%20this%E8%AF%A6%E8%A7%A3/#小结" class="sidebar-link">小结</a></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3%20%E5%AF%B9%E8%B1%A1/" class="sidebar-link">2-3 对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3%20%E5%AF%B9%E8%B1%A1/#对象-2" class="sidebar-link">对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3%20%E5%AF%B9%E8%B1%A1/#javascript类型" class="sidebar-link heading3">JavaScript类型</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3%20%E5%AF%B9%E8%B1%A1/#javascript-内置对象" class="sidebar-link heading3">JavaScript 内置对象</a></li></ul></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/" class="sidebar-link">2-3-2 对象的内容</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#对象的内容-2" class="sidebar-link">对象的内容</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#可计算属性名" class="sidebar-link heading3">可计算属性名</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#没有-方法-只有-属性" class="sidebar-link heading3">没有“方法”只有“属性”</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#复制对象" class="sidebar-link heading3">复制对象</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#属性描述符" class="sidebar-link">属性描述符</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#对象的不变性" class="sidebar-link">对象的不变性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#get" class="sidebar-link heading3">[[Get]]</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#put" class="sidebar-link heading3">[[Put]]</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#访问描述符-getter-和-setter" class="sidebar-link heading3">访问描述符（getter 和 setter）</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#判断对象是否有某属性" class="sidebar-link heading3">判断对象是否有某属性</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#枚举" class="sidebar-link heading3">枚举</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-3-2%20%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E5%AE%B9/#小结" class="sidebar-link">小结</a></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-4%20%E2%80%9C%E7%B1%BB%E2%80%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8EJavaScript/" class="sidebar-link">2-4 “类”设计模式与JavaScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-4%20%E2%80%9C%E7%B1%BB%E2%80%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8EJavaScript/#类设计模式与javascript对象机制-2" class="sidebar-link">类设计模式与JavaScript对象机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-4%20%E2%80%9C%E7%B1%BB%E2%80%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8EJavaScript/#类理论" class="sidebar-link heading3">类理论</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-4%20%E2%80%9C%E7%B1%BB%E2%80%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8EJavaScript/#类设计模式" class="sidebar-link heading3">类设计模式</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-4%20%E2%80%9C%E7%B1%BB%E2%80%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8EJavaScript/#javascript中的-类" class="sidebar-link heading3">JavaScript中的“类”</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-4%20%E2%80%9C%E7%B1%BB%E2%80%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8EJavaScript/#类" class="sidebar-link heading3">类</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-4%20%E2%80%9C%E7%B1%BB%E2%80%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8EJavaScript/#混入-mixin" class="sidebar-link heading3">混入（mixin）</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-4%20%E2%80%9C%E7%B1%BB%E2%80%9D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8EJavaScript/#小结" class="sidebar-link">小结</a></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-5%20%E5%8E%9F%E5%9E%8B/" class="sidebar-link">2-5 原型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-5%20%E5%8E%9F%E5%9E%8B/#prototype" class="sidebar-link">[[Prototype]]</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-5%20%E5%8E%9F%E5%9E%8B/#查找属性与原型链" class="sidebar-link heading3">查找属性与原型链</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-5%20%E5%8E%9F%E5%9E%8B/#属性设置和屏蔽" class="sidebar-link heading3">属性设置和屏蔽</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-5%20%E5%8E%9F%E5%9E%8B/#类" class="sidebar-link">“类”</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-5%20%E5%8E%9F%E5%9E%8B/#用原型模仿类" class="sidebar-link heading3">用原型模仿类</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-5%20%E5%8E%9F%E5%9E%8B/#那些为模仿类而生的名字" class="sidebar-link heading3">那些为模仿类而生的名字</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-5%20%E5%8E%9F%E5%9E%8B/#原型继承" class="sidebar-link">原型继承</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-5%20%E5%8E%9F%E5%9E%8B/#检查-实例-所属的-类" class="sidebar-link heading3">检查“实例”所属的&quot;类&quot;</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-5%20%E5%8E%9F%E5%9E%8B/#object-create" class="sidebar-link">Object.create</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-5%20%E5%8E%9F%E5%9E%8B/#小结" class="sidebar-link">小结</a></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/" aria-current="page" class="active sidebar-link">2-6 委托</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#面向委托的设计" class="sidebar-link">面向委托的设计</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#类理论" class="sidebar-link heading3">类理论</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#委托理论" class="sidebar-link heading3">委托理论</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#两者比较-委托更简洁" class="sidebar-link heading3">两者比较：委托更简洁</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#类与委托实现控件-按钮控件实例" class="sidebar-link">类与委托实现控件（按钮控件实例）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#控件-类-实现" class="sidebar-link heading3">控件“类”实现</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#委托对象实现" class="sidebar-link heading3">委托对象实现</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#更简洁的代码-登录和验证实例" class="sidebar-link heading3">更简洁的代码（登录和验证实例）</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#es6简洁语法" class="sidebar-link">ES6简洁语法</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#内省-判断a是否是b的实例或原型" class="sidebar-link">内省(判断a是否是b的实例或原型)</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#小结" class="sidebar-link">小结</a></li></ul></li><li><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/%E9%99%84%E5%BD%95/" class="sidebar-link">附录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/%E9%99%84%E5%BD%95/#动态作用域" class="sidebar-link">动态作用域</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/%E9%99%84%E5%BD%95/#es6中的class" class="sidebar-link">ES6中的Class</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/%E9%99%84%E5%BD%95/#class语法解决的问题" class="sidebar-link heading3">class语法解决的问题</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/%E9%99%84%E5%BD%95/#class语法带来的问题" class="sidebar-link heading3">class语法带来的问题</a></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/%E9%99%84%E5%BD%95/#class的静态与动态问题" class="sidebar-link heading3">class的静态与动态问题</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/%E9%99%84%E5%BD%95/#小结" class="sidebar-link">小结</a></li></ul></li></ul></section></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb disable"><!----></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">委托</span></h1> <div class="page-info"><!----> <!----><!----><span aria-label="Writing Date📅" data-balloon-pos="down" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2021-1-20</span></span><!----><!----><span aria-label="Reading Time⌛" data-balloon-pos="down" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>About 11 min</span> <meta property="timeRequired" content="PT11M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#面向委托的设计" class="anchor-link heading2"><div>面向委托的设计</div></a></li><li class="anchor"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#类理论" class="anchor-link heading3"><div>类理论</div></a></li><li class="anchor"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#委托理论" class="anchor-link heading3"><div>委托理论</div></a></li><li class="anchor"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#两者比较-委托更简洁" class="anchor-link heading3"><div>两者比较：委托更简洁</div></a></li><li class="anchor"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#类与委托实现控件-按钮控件实例" class="anchor-link heading2"><div>类与委托实现控件（按钮控件实例）</div></a></li><li class="anchor"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#控件-类-实现" class="anchor-link heading3"><div>控件“类”实现</div></a></li><li class="anchor"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#委托对象实现" class="anchor-link heading3"><div>委托对象实现</div></a></li><li class="anchor"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#更简洁的代码-登录和验证实例" class="anchor-link heading3"><div>更简洁的代码（登录和验证实例）</div></a></li><li class="anchor"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#es6简洁语法" class="anchor-link heading2"><div>ES6简洁语法</div></a></li><li class="anchor"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#内省-判断a是否是b的实例或原型" class="anchor-link heading2"><div>内省(判断a是否是b的实例或原型)</div></a></li><li class="anchor"><a href="/blog/YDKJS%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%8A%E5%8D%B7%EF%BC%89/2-6%20%E5%A7%94%E6%89%98/#小结" class="anchor-link heading2"><div>小结</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h1 id="委托"><a href="#委托" class="header-anchor">#</a> 委托</h1> <blockquote><p>[[Prototype]]机制是指对象的一个内部链接引用另一个对象。</p> <p><strong>这个机制的本质是对象间的关联关系。</strong></p></blockquote> <h2 id="面向委托的设计"><a href="#面向委托的设计" class="header-anchor">#</a> 面向委托的设计</h2> <p>面向委托的设计是一种非常不同于面向类的设计模式。</p> <p>接下来以一个例子介绍它们的不同。</p> <h3 id="类理论"><a href="#类理论" class="header-anchor">#</a> 类理论</h3> <p>类的设计方法可能是这样的:</p> <ol><li>定义一个通用父(基)类，可以将其命名为 Task，在 Task 类中定义所有任务都有的行为。</li> <li>接着定义子类 XYZ 和 ABC，它们都继承自 Task 并且会添加一些特殊的行为来处理对应的任务。</li></ol> <p><strong>非常重要的是，类设计模式鼓励你在继承时使用方法重写(和多态)。</strong></p> <p>你会发现许多行为可以先“抽象”到父类然后再用子类进行特殊化(重写)。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Task</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">outputTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 子类都有的行为，等待被重写（多态）</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">XYZ</span> <span class="token keyword">extends</span> <span class="token class-name">Task</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> label</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token operator">=</span> label<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">outputTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>label<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ABC</span> <span class="token keyword">extends</span> <span class="token class-name">Task</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="委托理论"><a href="#委托理论" class="header-anchor">#</a> 委托理论</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> Task <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">setId</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">outputId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">XYZ</span> <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>Task<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 建立关联，实现委托</span>

<span class="token constant">XYZ</span><span class="token punctuation">.</span><span class="token function-variable function">prepareTask</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">Id<span class="token punctuation">,</span> Label</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 委托给Task</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token operator">=</span> Label<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token constant">XYZ</span><span class="token punctuation">.</span><span class="token function-variable function">outputTaskDetails</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">outputId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 委托给Task</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// const ABC = Object.create(Task);</span>
<span class="token comment">// ...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>委托风格的几个特点：</p> <ul><li><p>通常来说，在委托中最好把状态等数据成员保存在委托者(XYZ)上。</p></li> <li><p>在类继承中，我们鼓励利用重写多态的优势，使得函数名相同，</p> <p>但是在委托中，应该避免同名引起的屏蔽（参考原型链查找规则），且提倡使用更有描述性的方法名，尤其是要写清相应对象行为的类型。这样容易理解和维护代码。</p></li> <li><p>在调用委托的函数时，比如setId、outputId，触发了this的<em>隐式绑定</em>，这是符合预期的。</p></li></ul> <p>委托的几个注意点：</p> <ul><li><p>互相委托是禁止的，因为引擎的开发者们发现在设置时检查并禁止一次无限循环引用要更加高效，否则每次从对象中查找属性时都需要进行检查。</p></li> <li><p>当你使用对象关联风格来编写行为委托设计模式时，并不需要关注是谁“构造了”对象。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> a1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// chrome</span>
a1<span class="token punctuation">;</span> <span class="token comment">// Foo {}</span>

<span class="token comment">// firefox</span>
a1<span class="token punctuation">;</span> <span class="token comment">// Object {}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul> <p><strong>这是一种极其强大的设计模式，和父类、子类、继承、多态等概念完全不同。</strong></p> <p>在你的脑海中对象并不是按照父类到子类的关系垂直组织的，而是通过任意方向的委托关联并排组织的。</p> <h3 id="两者比较-委托更简洁"><a href="#两者比较-委托更简洁" class="header-anchor">#</a> 两者比较：委托更简洁</h3> <p>参考以下两段代码：</p> <ul><li><p>典型的基于原型的面向对象</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">who</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>me <span class="token operator">=</span> who<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">identify</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">&quot;I am &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>me<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Bar</span><span class="token punctuation">(</span><span class="token parameter">who</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">,</span> who <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> <span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// “继承”</span>

<span class="token class-name">Bar</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">speak</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span> <span class="token string">&quot;Hello, &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">identify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> b1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bar</span><span class="token punctuation">(</span> <span class="token string">&quot;b1&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bar</span><span class="token punctuation">(</span> <span class="token string">&quot;b2&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
b1<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
b2<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>因为<code>原型、prototype属性、constructor</code>等的指向关系，</p> <p>使得<code>Foo、Bar、Foo.prototype、Bar.prototype、Function、Function.prototype、Object.prototype</code>间的关系变得非常复杂。</p> <p>(仔细整理一下下图的节点排列位置有利于看清它们间的关系。)</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div></li> <li><p>委托风格</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> Foo <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">who</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>me <span class="token operator">=</span> who<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">identify</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;I am &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>me<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Bar <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> Foo <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 委托</span>
Bar<span class="token punctuation">.</span><span class="token function-variable function">speak</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span> <span class="token string">&quot;Hello, &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">identify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> b1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> Bar <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> Bar <span class="token punctuation">)</span><span class="token punctuation">;</span>
b1<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span> <span class="token string">&quot;b1&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
b2<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span> <span class="token string">&quot;b2&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
b1<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
b2<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>通过比较可以看出，对象关联风格的代码显然更加简洁，因为这种代码只关注一件事：<strong>对象之间的关联关系</strong>。</p> <p>其他的“类”技巧都是非常复杂并且令人困惑的。去掉它们之后，事情会变得简单许多 (同时保留所有功能)。</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div></li></ul> <h2 id="类与委托实现控件-按钮控件实例"><a href="#类与委托实现控件-按钮控件实例" class="header-anchor">#</a> 类与委托实现控件（按钮控件实例）</h2> <h3 id="控件-类-实现"><a href="#控件-类-实现" class="header-anchor">#</a> 控件“类”实现</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Widget</span><span class="token punctuation">(</span><span class="token parameter">width<span class="token punctuation">,</span>height</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">=</span> width <span class="token operator">||</span> <span class="token number">50</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height <span class="token operator">||</span> <span class="token number">50</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$elem <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Widget</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">$where</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$elem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>$elem<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
      width<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">,</span>
      height<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span>
    <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendTo</span><span class="token punctuation">(</span> $where <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">Button</span><span class="token punctuation">(</span><span class="token parameter">width<span class="token punctuation">,</span>height<span class="token punctuation">,</span>label</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Widget</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用“super”构造函数</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token operator">=</span> label <span class="token operator">||</span> <span class="token string">&quot;Default&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$elem <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span> <span class="token string">&quot;&lt;button&gt;&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Button</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> <span class="token class-name">Widget</span><span class="token punctuation">.</span>prototype <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 让 Button“继承”Widget</span>
<span class="token comment">// 重写 render</span>
<span class="token class-name">Button</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">$where</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Widget</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">,</span> $where <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//“super”调用</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$elem<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Button</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">onClick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;Button '&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token operator">+</span> <span class="token string">&quot;' clicked!&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">$</span><span class="token punctuation">(</span> document <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> $body <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span> document<span class="token punctuation">.</span>body <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> btn1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Button</span><span class="token punctuation">(</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">&quot;Hello&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> btn2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Button</span><span class="token punctuation">(</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">&quot;World&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  btn1<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span> $body <span class="token punctuation">)</span><span class="token punctuation">;</span>
  btn2<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span> $body <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Widget</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">width<span class="token punctuation">,</span>height</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">=</span> width <span class="token operator">||</span> <span class="token number">50</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height <span class="token operator">||</span> <span class="token number">50</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$elem <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">$where</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$elem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$elem<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
        width<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span>
      <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendTo</span><span class="token punctuation">(</span> $where <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token keyword">extends</span> <span class="token class-name">Widget</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">width<span class="token punctuation">,</span>height<span class="token punctuation">,</span>label</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span> width<span class="token punctuation">,</span> height <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token operator">=</span> label <span class="token operator">||</span> <span class="token string">&quot;Default&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$elem <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span> <span class="token string">&quot;&lt;button&gt;&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">$where</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span> $where <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$elem<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;Button '&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token operator">+</span> <span class="token string">&quot;' clicked!&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>使用“基于原型的继承“代码中，除了有上一小节提到的关系混乱的缺点外，还有伪多态带来的麻烦，</p> <p>比如<code>Widget. prototype.render.call</code> 从“子类”方法中引用“父类”中的基础方法。</p> <p>在ES6的代码中<code>super函数</code>缓解了这个问题，但是这里并没有真正的类，<strong>class 仍然是通过 [[Prototype]] 机制实现的</strong>。</p> <p>无论你使用的是传统的原型语法还是 ES6 中的新语法糖，你仍然需要用“类”的概念来对问题(UI 控件)进行建模。</p> <h3 id="委托对象实现"><a href="#委托对象实现" class="header-anchor">#</a> 委托对象实现</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> Widget <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">width<span class="token punctuation">,</span>height</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">=</span> width <span class="token operator">||</span> <span class="token number">50</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height <span class="token operator">||</span> <span class="token number">50</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$elem <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">insert</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">$where</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$elem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$elem<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
        width<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendTo</span><span class="token punctuation">(</span> $where <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> Button <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> Widget <span class="token punctuation">)</span><span class="token punctuation">;</span>
Button<span class="token punctuation">.</span><span class="token function-variable function">setup</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">width<span class="token punctuation">,</span>height<span class="token punctuation">,</span>label</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 委托调用</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span> width<span class="token punctuation">,</span> height <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token operator">=</span> label <span class="token operator">||</span> <span class="token string">&quot;Default&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$elem <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span> <span class="token string">&quot;&lt;button&gt;&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
Button<span class="token punctuation">.</span><span class="token function-variable function">build</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">$where</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 委托调用</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span> $where <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$elem<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Button<span class="token punctuation">.</span><span class="token function-variable function">onClick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">&quot;Button '&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>label <span class="token operator">+</span> <span class="token string">&quot;' clicked!&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">$</span><span class="token punctuation">(</span> document <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> $body <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span> document<span class="token punctuation">.</span>body <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> btn1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> Button <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> btn2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> Button <span class="token punctuation">)</span><span class="token punctuation">;</span>
  btn1<span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">&quot;Hello&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  btn2<span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">&quot;World&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
  btn1<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span> $body <span class="token punctuation">)</span><span class="token punctuation">;</span>
  btn2<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span> $body <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>同样地，我们建议在委托与被委托者间尽量不用同名函数，比如 <code>insert / build</code>，<code>init / setup</code>。</p> <p>另外，与“类”实现相比，委托实现在调用<code>setup</code>函数前，不会被初始化。</p> <p><strong>对象关联可以更好地支持关注分离(separation of concerns)原则，创建和初始化并不需要合并为一个步骤。</strong></p> <h3 id="更简洁的代码-登录和验证实例"><a href="#更简洁的代码-登录和验证实例" class="header-anchor">#</a> 更简洁的代码（登录和验证实例）</h3> <p>对象关联除了能让代码看起来更简洁并且更具扩展性外还可以通过行为委托模式简化代码结构。</p> <p>我们来看最后一个例子，它展示了对象关联如何简化整体设计。</p> <p>在这个场景中我们有两个控制器对象，一个用来操作网页中的登录表单，另一个用来与服 务器进行验证(通信)。</p> <h4 id="类方法"><a href="#类方法" class="header-anchor">#</a> “类方法”</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>errors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Controller</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">showDialog</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">title<span class="token punctuation">,</span> msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 给用户显示标题和消息</span>
<span class="token class-name">Controller</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">success</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showDialog</span><span class="token punctuation">(</span><span class="token string">&quot;Success&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Controller</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">failure</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>errors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showDialog</span><span class="token punctuation">(</span><span class="token string">&quot;Error&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">LoginController</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Controller</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 把子类关联到父类</span>
<span class="token class-name">LoginController</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Controller</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">LoginController</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getUser</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;login_username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">LoginController</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getPassword</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;login_password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">LoginController</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">validateEntry</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">user<span class="token punctuation">,</span> pw</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  user <span class="token operator">=</span> user <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  pw <span class="token operator">=</span> pw <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>user <span class="token operator">&amp;&amp;</span> pw<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span>
      <span class="token string">&quot;Please enter a username &amp; password!&quot;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span>
      <span class="token string">&quot;Password must be 5+ characters!&quot;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 如果执行到这里说明通过验证</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 重写基础的 failure()</span>
<span class="token class-name">LoginController</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">failure</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Controller</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;Login invalid: &quot;</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">AuthController</span><span class="token punctuation">(</span><span class="token parameter">login</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Controller</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 合成</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>login <span class="token operator">=</span> login<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 把子类关联到父类</span>
<span class="token class-name">AuthController</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Controller</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">AuthController</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">server</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> url<span class="token punctuation">,</span>
    data<span class="token operator">:</span> data
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">AuthController</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">checkAuth</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> pw <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">validateEntry</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> pw<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">server</span><span class="token punctuation">(</span><span class="token string">&quot;/check-auth&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      user<span class="token operator">:</span> user<span class="token punctuation">,</span>
      pw<span class="token operator">:</span> pw
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 重写基础的 success()</span>
<span class="token class-name">AuthController</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">success</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Controller</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;Authenticated!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 重写基础的 failure()</span>
<span class="token class-name">AuthController</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">failure</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Controller</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;Auth Failed: &quot;</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> auth <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
auth<span class="token punctuation">.</span><span class="token function">checkAuth</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoginController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 除了继承，我们还需要合成</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br></div></div><p>AuthController 需要使用 LoginController，因此我们实例化后者(new LoginController)并用一个类成员属性 this.login 来引用它，这样 AuthController 就可以调用 LoginController 的行为。</p> <p>你可能想让 AuthController 继承 LoginController 或者相反，这样我们就通 过继承链实现了真正的合成。</p> <p>但是这就是类继承在问题领域建模时会产生的问题，因为 AuthController 和 LoginController 都不具备对方的基础行为， 所以这种<strong>继承关系是不恰当的</strong>。我们的解决办法是进行一些简单的合成从而让它们既不必互相继承又可以互相合作。</p> <h4 id="委托-2"><a href="#委托-2" class="header-anchor">#</a> 委托</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> LoginController <span class="token operator">=</span> <span class="token punctuation">{</span>
  errors<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getUser</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;login_username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getPassword</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;login_password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">validateEntry</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">user<span class="token punctuation">,</span> pw</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    user <span class="token operator">=</span> user <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pw <span class="token operator">=</span> pw <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>user <span class="token operator">&amp;&amp;</span> pw<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span><span class="token string">&quot;Please enter a username &amp; password!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span><span class="token string">&quot;Password must be 5+ characters!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 如果执行到这里说明通过验证</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">showDialog</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">title<span class="token punctuation">,</span> msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 给用户显示标题和消息</span>
  <span class="token function-variable function">failure</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>errors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showDialog</span><span class="token punctuation">(</span><span class="token string">&quot;Error&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Login invalid: &quot;</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 让 AuthController 委托 LoginController</span>
<span class="token keyword">var</span> AuthController <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>LoginController<span class="token punctuation">)</span><span class="token punctuation">;</span>
AuthController<span class="token punctuation">.</span>errors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
AuthController<span class="token punctuation">.</span><span class="token function-variable function">checkAuth</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> pw <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validateEntry</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> pw<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">server</span><span class="token punctuation">(</span><span class="token string">&quot;/check-auth&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      user<span class="token operator">:</span> user<span class="token punctuation">,</span>
      pw<span class="token operator">:</span> pw
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">accepted</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rejected</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
AuthController<span class="token punctuation">.</span><span class="token function-variable function">server</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> url<span class="token punctuation">,</span>
    data<span class="token operator">:</span> data
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
AuthController<span class="token punctuation">.</span><span class="token function-variable function">accepted</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showDialog</span><span class="token punctuation">(</span><span class="token string">&quot;Success&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Authenticated!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
AuthController<span class="token punctuation">.</span><span class="token function-variable function">rejected</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span><span class="token string">&quot;Auth Failed: &quot;</span> <span class="token operator">+</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

AuthController<span class="token punctuation">.</span><span class="token function">checkAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 多个实例</span>
<span class="token keyword">var</span> controller1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> AuthController <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> controller2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> AuthController <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><p>在行为委托模式中，AuthController 和 LoginController 只是对象，它们之间是兄弟关系， 并不是父类和子类的关系。</p> <p>代码中 AuthController 委托了 LoginController，<em><strong>反向委托也完全没问题</strong></em>。</p> <p>这种模式的重点在于只需要两个实体(LoginController 和 AuthController)，而之前的模式需要三个。</p> <p>总结：我们用一种(极其)简单的设计实现了同样的功能，这就是对象关联风格代码和行为委托设计模式的力量。</p> <h2 id="es6简洁语法"><a href="#es6简洁语法" class="header-anchor">#</a> ES6简洁语法</h2> <p>可以利用ES6中的<code>Object.setPrototypeOf</code>来设置原型，替代原本的<code>Object.create</code>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> AuthController <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token comment">// 现在把 AuthController 关联到 LoginController</span>
Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span> AuthController<span class="token punctuation">,</span> LoginController <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ES6函数简洁语法的一个缺点：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> Foo <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">baz</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 去掉语法糖之后的代码</span>
<span class="token keyword">var</span> Foo <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">bar</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 匿名函数</span>
  <span class="token function-variable function">baz</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>匿名函数没有 name 标识符，这会导致:</p> <ol><li>调试栈更难追踪;</li> <li>自我引用(递归、事件(解除)绑定，等等)更难;</li> <li>代码(稍微)更难理解。</li></ol> <p>简洁方法无法避免第 2 个缺点，它们不具备可以自我引用的词法标识符。</p> <p>如果你需要自我引用的话，那最好使用传统的具名函数表达式来定义对应的函数，不要使用简洁方法。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> Foo <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">bar</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> Foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span> x <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">baz</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">baz</span><span class="token punctuation">(</span> x <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="内省-判断a是否是b的实例或原型"><a href="#内省-判断a是否是b的实例或原型" class="header-anchor">#</a> 内省(判断a是否是b的实例或原型)</h2> <p>在面向类的程序中，内省的意思是检查实例的类型。</p> <p>类实例的自省主要目的是通过创建方式来判断对象的结构和功能。</p> <p>判断方法：</p> <ul><li><p>第五章提到了<code>instanceof</code>操作符，这不是一个好的方法，容易让人误解。</p></li> <li><p>鸭子类型，比如promise会有then方法，但有then方法的对象不一定是promise对象。</p></li> <li><p><code>a.isPrototypeOf(b)</code>，这个方法回答a是否在b的原型链上。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> Foo <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> Bar <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> Foo <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> Bar <span class="token punctuation">)</span><span class="token punctuation">;</span>

Foo<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span> Bar <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span> Bar <span class="token punctuation">)</span> <span class="token operator">===</span> Foo<span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token comment">// 让b1关联到Foo和Bar</span>
Foo<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span> b1 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Bar<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span> b1 <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span> b1 <span class="token punctuation">)</span> <span class="token operator">===</span> Bar<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul> <h2 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h2> <p>在软件架构中你可以选择是否使用类和继承设计模式。</p> <p><strong>行为委托</strong>是比类少见但是更强大的设计模式。行为委托认为对象之间是兄弟关系，互相委托，而不是父类和子类的关系。</p> <p><strong>JavaScript 的 [[Prototype]] 机制本质上就是行为委托机制。</strong></p> <p>也就是说，我们可以选择在 JavaScript 中努力实现类机制(参见第 4 和第 5 章)，也可以拥抱更自然的 [[Prototype]] 委托机制。</p> <p>只用对象来设计代码，可以让语法更加简洁，代码结构更加清晰。</p> <p>对象关联是一种编码风格，它倡导的是<strong>直接创建和关联对象，不把它们抽象成类</strong>。</p> <p>对象关联可以用基于 [[Prototype]] 的行为委托非常自然地实现。</p></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><!----> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">April 21, 2021 21:30</span></div> <!----></footer> <!----> <!----> <!----> <div class="content__page-bottom"></div></main> <!----></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button class="pswp__button pswp__button--close"></button> <button class="pswp__button pswp__button--share"></button> <button class="pswp__button pswp__button--fs"></button> <button class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button class="pswp__button pswp__button--arrow--left"></button> <button class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/blog/assets/js/app.79f116af.js" defer></script><script src="/blog/assets/js/vendors~layout-Layout.8c2cbbba.js" defer></script><script src="/blog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.1c0cc028.js" defer></script><script src="/blog/assets/js/page-委托.f8d0b6b3.js" defer></script><script src="/blog/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.abaae08c.js" defer></script>
  </body>
</html>
